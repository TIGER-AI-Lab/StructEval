
import csv
from dataclasses import dataclass

@dataclass
class Artifact:
    artifact_id: str
    artifact_name: str
    discovery: dict
    material: dict
    dimensions: dict
    condition: dict
    significance: dict

    def to_csv(self):
        return (
            f"{self.artifact_id},{self.artifact_name},{self.discovery['site']},{self.discovery['country']},{self.discovery['year']},{self.discovery['method']},{self.material['primary']},{self.material.get('secondary', '')},{self.dimensions['height_cm']},{self.dimensions['width_cm']},{self.dimensions['depth_cm']},{self.condition['current_status']},{self.condition.get('restoration_history', '')},{self.significance['cultural_importance']},{self.significance['estimated_value_usd']}"
        )

with open('artifacts.csv', 'w', newline='') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(["artifact_id", "artifact_name", "discovery.site", "discovery.country", "discovery.year", "discovery.method", "material.primary", "material.secondary", "dimensions.height_cm", "dimensions.width_cm", "dimensions.depth_cm", "condition.current_status", "condition.restoration_history", "significance.cultural_importance", "significance.estimated_value_usd"])
    
    artifact = Artifact(
        artifact_id="ART-001",
        artifact_name="Ancient Vase",
        discovery={"site": "Ancient City", "country": "Greece", "year": 500, "method": "Excavation"},
        material={"primary": "Terracotta", "secondary": ""},
        dimensions={"height_cm": 30, "width_cm": 20, "depth_cm": 10},
        condition={"current_status": "Intact", "restoration_history": ""},
        significance={"cultural_importance": "Highly significant to Greek culture", "estimated_value_usd": 100000}
    )
    
    writer.writerow(artifact.to_csv())
