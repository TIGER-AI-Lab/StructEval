
import csv
from dataclasses import dataclass

@dataclass
class Artifact:
    artifact_id: str
    artifact_name: str
    discovery: dict
    material: dict
    dimensions: dict
    condition: dict
    provenance: dict
    exhibit: dict

    def to_csv(self):
        return (
            f"{self.artifact_id},{self.artifact_name},{self.discovery['site']},{self.discovery['country']},{self.discovery['year']},{self.material['primary']},{self.material['secondary']},{self.dimensions['height_cm']},{self.dimensions['width_cm']},{self.dimensions['depth_cm']},{self.condition['current_state']},{self.condition['restoration_years']},{self.provenance['previous_owners']},{self.provenance['auction_history']},{self.exhibit['locations']}"
        )

def main():
    artifact = Artifact(
        artifact_id="ART001",
        artifact_name="Ancient Vase",
        discovery={"site": "Ancient City", "country": "Greece", "year": 500},
        material={"primary": "Terracotta", "secondary": "Glaze"},
        dimensions={"height_cm": 30.5, "width_cm": 20.2, "depth_cm": 10.1},
        condition={"current_state": "intact", "restoration_years": "2010,2015"},
        provenance={"previous_owners": "John Smith, Jane Doe", "auction_history": "Sotheby's 2010, Christie's 2015"},
        exhibit={"locations": "The Met, British Museum"}
    )

    with open("artifact.csv", "w", newline="") as csvfile:
        writer = csv.writer(csvfile)
        writer.writerow(["artifact_id", "artifact_name", "discovery.site", "discovery.country", "discovery.year", "material.primary", "material.secondary", "dimensions.height_cm", "dimensions.width_cm", "dimensions.depth_cm", "condition.current_state", "condition.restoration_years", "provenance.previous_owners", "provenance.auction_history", "exhibit.locations"])
        writer.writerow(artifact.to_csv().split(","))

if __name__ == "__main__":
    main()
