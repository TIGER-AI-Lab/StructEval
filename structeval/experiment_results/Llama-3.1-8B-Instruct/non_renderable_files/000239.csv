
import csv
import re

def extract_data(text):
    data = {
        'species_id': '',
        'species_name': '',
        'classification': '',
        'habitat_type': '',
        'average_lifespan_years': 0,
        'discovery_date': '',
        'is_endangered': False,
        'average_height_cm': 0,
        'diet': '',
        'origin_planet': '',
        'notable_traits': '',
        'first_observed_by': '',
        'color_variations': '',
        'reproduction_method': '',
        'population_estimate': 0
    }

    # Species ID
    data['species_id'] = re.search(r'[A-Z][A-Z0-9]+', text).group()

    # Species Name
    data['species_name'] = re.search(r'([A-Z][a-z]+ [A-Z][a-z]+)', text).group()

    # Classification
    data['classification'] = re.search(r'(mammal|reptile|other)', text).group()

    # Habitat Type
    data['habitat_type'] = re.search(r'(aquatic|terrestrial|aerial)', text).group()

    # Average Lifespan Years
    data['average_lifespan_years'] = int(re.search(r'\d{1,3}', text).group())

    # Discovery Date
    data['discovery_date'] = re.search(r'\d{4}-\d{2}-\d{2}', text).group()

    # Is Endangered
    data['is_endangered'] = re.search(r'(true|false)', text, re.IGNORECASE).group().lower() == 'true'

    # Average Height CM
    data['average_height_cm'] = float(re.search(r'\d+\.\d+', text).group())

    # Diet
    data['diet'] = re.search(r'(herbivore|carnivore|omnivore|other)', text).group()

    # Origin Planet
    data['origin_planet'] = re.search(r'([A-Z][a-z]+)', text).group()

    # Notable Traits
    data['notable_traits'] = re.search(r'([A-Z][a-z]+; [A-Z][a-z]+)', text).group()

    # First Observed By
    data['first_observed_by'] = re.search(r'([A-Z][a-z]+)', text).group()

    # Color Variations
    data['color_variations'] = re.search(r'([A-Z][a-z]+; [A-Z][a-z]+)', text).group()

    # Reproduction Method
    data['reproduction_method'] = re.search(r'(oviparous|viviparous|other)', text).group()

    # Population Estimate
    data['population_estimate'] = int(re.search(r'\d{1,3}', text).group())

    return data

# Example usage
text = """
The newly discovered alien species, Zorvathus Maximus, is a mammal that inhabits the terrestrial environment of the planet Xylophia-IV. It has an average lifespan of 12 years and was first observed by the team led by Dr. Jane Smith on 2022-01-01. The species is considered endangered due to habitat destruction. The average height of the species is 150.5 cm, and it has a diet of herbivore. The species has notable traits such as its ability to jump long distances and its distinctive color variations of blue and green. The species reproduces oviparously, and the current estimated population is 500 individuals.
"""

data = extract_data(text)

with open('species_data.csv', 'w', newline='') as csvfile:
    fieldnames = ['species_id', 'species_name', 'classification', 'habitat_type', 'average_lifespan_years', 'discovery_date', 'is_endangered', 'average_height_cm', 'diet', 'origin_planet', 'notable_traits', 'first_observed_by', 'color_variations', 'reproduction_method', 'population_estimate']
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)

    writer.writeheader()
    writer.writerow(data)
