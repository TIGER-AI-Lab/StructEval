
import csv
from datetime import timedelta

class Album:
    def __init__(self, album_id, album_title, artist_name, release_year, genre, label, producer, tracklist, cover_url):
        self.album_id = album_id
        self.album_title = album_title
        self.artist_name = artist_name
        self.release_year = release_year
        self.genre = genre
        self.label = label
        self.producer = producer
        self.tracklist = tracklist
        self.cover_url = cover_url

    def calculate_total_duration(self):
        total_seconds = 0
        for track in self.tracklist:
            duration = track['duration']
            total_seconds += int(duration.split(':')[0]) * 60 + int(duration.split(':')[1])
        return str(timedelta(seconds=total_seconds)).split(':')[-2:]


def create_album(tracklist):
    tracklist_count = len(tracklist)
    tracklist_first_title = tracklist[0]['title']
    tracklist_first_duration = tracklist[0]['duration']
    tracklist_last_title = tracklist[-1]['title']
    tracklist_last_duration = tracklist[-1]['duration']

    album = Album(
        album_id='ALB001',
        album_title='Album Title',
        artist_name='Artist Name',
        release_year=2022,
        genre='Jazz',
        label='Record Label',
        producer='Producer Name',
        tracklist=tracklist,
        cover_url='https://example.com/cover.jpg'
    )

    return {
        'album_id': album.album_id,
        'album_title': album.album_title,
        'artist_name': album.artist_name,
        'release_year': album.release_year,
        'genre': album.genre,
        'label': album.label,
        'producer': album.producer,
        'tracklist': ';'.join([track['title'] for track in album.tracklist]),
        'tracklist_count': tracklist_count,
        'tracklist_first_title': tracklist_first_title,
        'tracklist_first_duration': tracklist_first_duration,
        'tracklist_last_title': tracklist_last_title,
        'tracklist_last_duration': tracklist_last_duration,
        'total_duration': album.calculate_total_duration()[0] + ':' + album.calculate_total_duration()[1]
    }


tracklist = [
    {'title': 'Track 1', 'duration': '03:45'},
    {'title': 'Track 2', 'duration': '04:20'},
    {'title': 'Track 3', 'duration': '05:10'}
]

album_data = create_album(tracklist)

with open('album_data.csv', 'w', newline='') as csvfile:
    fieldnames = ['album_id', 'album_title', 'artist_name', 'release_year', 'genre', 'label', 'producer', 'tracklist', 'tracklist_count', 'tracklist_first_title', 'tracklist_first_duration', 'tracklist_last_title', 'tracklist_last_duration', 'total_duration', 'cover_url']
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)

    writer.writeheader()
    writer.writerow(album_data)
