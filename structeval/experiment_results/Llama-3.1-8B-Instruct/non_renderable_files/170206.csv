
import xml.etree.ElementTree as ET
import csv

tree = ET.parse('gallery.xml')
root = tree.getroot()

with open('gallery.csv', 'w', newline='') as csvfile:
    fieldnames = ['PaintingID', 'Title', 'Artist', 'YearCreated', 'Medium', 'EstimatedValueUSD', 'LastAuctionDate']
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)

    writer.writeheader()
    for painting in root.findall('painting'):
        writer.writerow({
            'PaintingID': painting.find('PaintingID').text,
            'Title': painting.find('Title').text,
            'Artist': painting.find('Artist').text,
            'YearCreated': painting.find('YearCreated').text,
            'Medium': painting.find('Medium').text,
            'EstimatedValueUSD': painting.find('EstimatedValueUSD').text,
            'LastAuctionDate': painting.find('LastAuctionDate').text
        })
