
import csv
from datetime import datetime

class Artifact:
    def __init__(self, artifact_id, artifact_name, origin_civilization, discovery_date, material, estimated_age_years, dimensions, location, current_condition, notable_markings):
        self.artifact_id = artifact_id
        self.artifact_name = artifact_name
        self.origin_civilization = origin_civilization
        self.discovery_date = discovery_date
        self.material = material
        self.estimated_age_years = estimated_age_years
        self.dimensions = dimensions
        self.location = location
        self.current_condition = current_condition
        self.notable_markings = notable_markings

    def to_csv(self):
        return [
            self.artifact_id,
            self.artifact_name,
            self.origin_civilization,
            self.discovery_date,
            self.material['primary'],
            self.material.get('secondary', ''),
            self.estimated_age_years,
            self.dimensions['length_cm'],
            self.dimensions['width_cm'],
            self.dimensions['height_cm'],
            self.location['site_name'],
            self.location['latitude'],
            self.location['longitude'],
            self.current_condition['status'],
            str(self.current_condition['restoration_needed']).lower(),
            self.notable_markings[0]['type'],
            self.notable_markings[0]['description']
        ]

# Example usage
artifact = Artifact(
    'A001',
    'Golden Mask',
    'Ancient Egyptian',
    datetime(2020, 1, 1).isoformat(),
    {'primary': 'Gold', 'secondary': 'Copper'},
    3000,
    {'length_cm': 20, 'width_cm': 15, 'height_cm': 10},
    {'site_name': 'Pyramid of Giza', 'latitude': 29.9792, 'longitude': 31.1376},
    {'status': 'Intact', 'restoration_needed': False},
    [{'type': 'Inscription', 'description': 'Hieroglyphic text'}]
)

with open('artifact.csv', 'w', newline='') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(['artifact_id', 'artifact_name', 'origin_civilization', 'discovery_date', 'material.primary', 'material.secondary', 'estimated_age_years', 'dimensions.length_cm', 'dimensions.width_cm', 'dimensions.height_cm', 'location.site_name', 'location.latitude', 'location.longitude', 'current_condition.status', 'current_condition.restoration_needed', 'notable_markings[0].type', 'notable_markings[0].description'])
    writer.writerow(artifact.to_csv())
