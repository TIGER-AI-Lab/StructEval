
import csv
from dataclasses import dataclass

@dataclass
class Artifact:
    name: str
    origin: str
    period: str
    material: str
    dimensions: dict
    condition: str
    discovery: dict
    display: dict
    provenance: dict

@dataclass
class Discovery:
    location: str
    date: str
    archaeologist: str

@dataclass
class Display:
    location: str
    lighting: str

@dataclass
class Provenance:
    history: str

@dataclass
class Dimensions:
    height_cm: float
    width_cm: float
    depth_cm: float

def generate_csv_row(exhibit_id: str, artifact: Artifact):
    csv_row = {
        'exhibit_id': exhibit_id,
        'artifact.name': artifact.name,
        'artifact.origin': artifact.origin,
        'artifact.period': artifact.period,
        'artifact.material': artifact.material,
        'artifact.dimensions.height_cm': artifact.dimensions.height_cm,
        'artifact.dimensions.width_cm': artifact.dimensions.width_cm,
        'artifact.dimensions.depth_cm': artifact.dimensions.depth_cm,
        'artifact.condition': artifact.condition,
        'artifact.discovery.location': artifact.discovery.location,
        'artifact.discovery.date': artifact.discovery.date,
        'artifact.discovery.archaeologist': artifact.discovery.archaeologist,
        'artifact.display.location': artifact.display.location,
        'artifact.display.lighting': artifact.display.lighting,
        'artifact.provenance.history': artifact.provenance.history
    }
    return csv_row

def write_csv_row(csv_row: dict, filename: str):
    with open(filename, 'a', newline='') as csvfile:
        fieldnames = list(csv_row.keys())
        writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
        if csvfile.tell() == 0:
            writer.writeheader()
        writer.writerow(csv_row)

# Example usage
exhibit_id = 'exhibit-123'
artifact = Artifact(
    name='Artifact 1',
    origin='Ancient Greece',
    period='Classical',
    material='Marble',
    dimensions=Dimensions(height_cm=50.0, width_cm=30.0, depth_cm=20.0),
    condition='Excellent',
    discovery=Discovery(location='Site 1', date='2022-01-01', archaeologist='John Doe'),
    display=Display(location='Hall 3, Case B', lighting='LED spotlight'),
    provenance=Provenance(history='Acquired from private collector in 2010')
)

csv_row = generate_csv_row(exhibit_id, artifact)
write_csv_row(csv_row, 'museum_exhibits.csv')
