
import xml.etree.ElementTree as ET
import csv

root = ET.fromstring('''
<artifacts>
  <artifact>
    <ArtifactID>AF-001</ArtifactID>
    <DiscoverySite>Pyramid of Solitude</DiscoverySite>
    <Era>Neolithic</Era>
    <Material>Obsidian</Material>
    <EstimatedValueUSD>12000</EstimatedValueUSD>
    <DateDiscovered>2019-03-12</DateDiscovered>
  </artifact>
  <artifact>
    <ArtifactID>AF-002</ArtifactID>
    <DiscoverySite>Crystal Caverns</DiscoverySite>
    <Era>Bronze Age</Era>
    <Material>Bronze</Material>
    <EstimatedValueUSD>5400</EstimatedValueUSD>
    <DateDiscovered>2021-07-21</DateDiscovered>
  </artifact>
  <artifact>
    <ArtifactID>AF-003</ArtifactID>
    <DiscoverySite>Sunken Library</DiscoverySite>
    <Era>Classical</Era>
    <Material>Marble</Material>
    <EstimatedValueUSD>32000</EstimatedValueUSD>
    <DateDiscovered>2017-11-05</DateDiscovered>
  </artifact>
  <artifact>
    <ArtifactID>AF-004</ArtifactID>
    <DiscoverySite>Emerald Archipelago</DiscoverySite>
    <Era>Iron Age</Era>
    <Material>Iron</Material>
    <EstimatedValueUSD>8700</EstimatedValueUSD>
    <DateDiscovered>2020-02-28</DateDiscovered>
  </artifact>
  <artifact>
    <ArtifactID>AF-005</ArtifactID>
    <DiscoverySite>Whispering Dunes</DiscoverySite>
    <Era>Medieval</Era>
    <Material>Glass</Material>
    <EstimatedValueUSD>15000</EstimatedValueUSD>
    <DateDiscovered>2022-09-14</DateDiscovered>
  </artifact>
  <artifact>
    <ArtifactID>AF-006</ArtifactID>
    <DiscoverySite>Frozen Citadel</DiscoverySite>
    <Era>Renaissance</Era>
    <Material>Porcelain</Material>
    <EstimatedValueUSD>23000</EstimatedValueUSD>
    <DateDiscovered>2018-06-30</DateDiscovered>
  </artifact>
</artifacts>
''')

with open('output.csv', 'w', newline='') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(['ArtifactID', 'DiscoverySite', 'Era', 'Material', 'EstimatedValueUSD', 'DateDiscovered'])
    for artifact in root.findall('artifact'):
        writer.writerow([artifact.find('ArtifactID').text,
                         artifact.find('DiscoverySite').text,
                         artifact.find('Era').text,
                         artifact.find('Material').text,
                         artifact.find('EstimatedValueUSD').text,
                         artifact.find('DateDiscovered').text])
