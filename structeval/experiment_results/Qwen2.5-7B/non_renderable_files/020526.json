
import csv
import json

csv_file = 'exhibit_data.csv'
json_file = 'exhibit_data.json'

data = []

with open(csv_file, mode='r', encoding='utf-8') as file:
    reader = csv.DictReader(file)
    for row in reader:
        artifacts = []
        for artifact in row['artifacts'].strip('[]').split(','):
            artifact_data = {k.strip(): v.strip() for k, v in (item.split(':') for item in artifact.split(','))}
            artifacts.append(artifact_data)
        events = []
        for event in row['events'].strip('[]').split(','):
            event_data = {k.strip(): v.strip() for k, v in (item.split(':') for item in event.split(','))}
            events.append(event_data)
        data.append({
            'exhibit_id': row['exhibit_id'],
            'title': row['title'],
            'curator': {
                'name': row['curator.name'],
                'contact': {
                    'email': row['curator.contact.email'],
                    'phone': row['curator.contact.phone']
                }
            },
            'artifacts': artifacts,
            'events': events
        })

with open(json_file, 'w', encoding='utf-8') as file:
    json.dump(data, file, indent=4)
