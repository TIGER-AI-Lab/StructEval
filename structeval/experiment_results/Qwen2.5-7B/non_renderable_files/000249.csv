
import pandas as pd

def convert_to_csv(officer_description):
    # Define the data structure
    data = {
        'character_name': [officer_description['name']],
        'species': [officer_description['species']],
        'home_planet': [officer_description['home_planet']],
        'rank': [officer_description['rank']],
        'assignment.mission_name': [officer_description['mission']['name']],
        'assignment.start_date': [officer_description['mission']['start_date']],
        'assignment.end_date': [officer_description['mission'].get('end_date', '')],
        'assignment.status': [officer_description['mission']['status']],
        'skills[0].skill_name': [officer_description['skills'][0]['name']],
        'skills[0].proficiency': [officer_description['skills'][0]['proficiency']],
        'skills[1].skill_name': [officer_description['skills'][1]['name']],
        'skills[1].proficiency': [officer_description['skills'][1]['proficiency']],
        'equipment[0].item_name': [officer_description['equipment'][0]['name']],
        'equipment[0].quantity': [officer_description['equipment'][0]['quantity']],
        'equipment[1].item_name': [officer_description['equipment'][1]['name']]
    }

    # Create a DataFrame from the data
    df = pd.DataFrame(data)

    # Convert the DataFrame to a CSV string
    csv_string = df.to_csv(index=False)

    return csv_string

# Example usage
officer_description = {
    'name': 'John Doe',
    'species': 'Human',
    'home_planet': 'Earth',
    'rank': 'Lieutenant',
    'mission': {
        'name': 'Operation: Alpha',
        'start_date': '2023-01-01',
        'end_date': '2023-01-31',
        'status': 'Completed'
    },
    'skills': [
        {'name': 'Leadership', 'proficiency': 8},
        {'name': 'Engineering', 'proficiency': 7}
    ],
    'equipment': [
        {'name': 'Phaser', 'quantity': 2},
        {'name': 'Tricorder', 'quantity': 1}
    ]
}

csv_output = convert_to_csv(officer_description)
print(csv_output)
